Task 1  	#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <fcntl.h>
#include <sys/mman.h>
#include <sys/types.h>
#include <sys/stat.h>

int main(void)
{
    int fd;
    int i;
    size_t length;

    struct A {
        double f;
        double f2;
    } *ptr, *tmpptr;

    fd = open("mapped.dat", O_RDWR | O_CREAT, 0666);
    if (fd == -1) {
        printf("File open failed!\n");
        exit(1);
    }

    length = 10000 * sizeof(struct A);

    if (ftruncate(fd, length) == -1) {
        printf("ftruncate failed!\n");
        exit(1);
    }

    ptr = mmap(NULL, length, PROT_WRITE | PROT_READ, MAP_SHARED, fd, 0);

    close(fd);

    if (ptr == MAP_FAILED) {
        printf("Mapping failed!\n");
        exit(2);
    }

    tmpptr = ptr;
    for (i = 1; i <= 10000; i++) {
        tmpptr->f = i;
        tmpptr->f2 = i * i;
        tmpptr++;
    }

    munmap(ptr, length);

    return 0;
}

 Task 2 (модифіковане перше завдання) #include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <fcntl.h>
#include <sys/mman.h>
#include <sys/types.h>
#include <sys/stat.h>

int main(void)
{
    int fd;
    int i;
    size_t length;

    struct A {
        double f;
        double f2;
    } *ptr, *tmpptr;

    fd = open("mapped.dat", O_RDWR | O_CREAT, 0666);
    if (fd == -1) {
        printf("File open failed!\n");
        exit(1);
    }

    length = 1000000 * sizeof(struct A);

    if (ftruncate(fd, length) == -1) {
        printf("ftruncate failed!\n");
        exit(1);
    }

    ptr = mmap(NULL, length, PROT_WRITE | PROT_READ, MAP_SHARED, fd, 0);

    close(fd);

    if (ptr == MAP_FAILED) {
        printf("Mapping failed!\n");
        exit(2);
    }

    tmpptr = ptr;
    for(i = 1; i <= 1000000; i++) {
        tmpptr->f = i;
        tmpptr->f2 = i * i;
        tmpptr++;
    }

    munmap(ptr, length);

    return 0;
}

 (саме завдання) #include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <fcntl.h>
#include <sys/mman.h>
#include <sys/types.h>
#include <sys/stat.h>

int main(void)
{
    int fd;
    size_t length;
    double sum = 0;

    struct A {
        double f;
        double f2;
    } *ptr, *tmpptr;

    fd = open("mapped.dat", O_RDONLY);
    if (fd == -1) {
        printf("File open failed!\n");
        exit(1);
    }

    length = 1000000 * sizeof(struct A);

    ptr = mmap(NULL, length, PROT_READ, MAP_SHARED, fd, 0);
    close(fd);

    if (ptr == MAP_FAILED) {
        printf("Mapping failed!\n");
        exit(2);
    }

    tmpptr = ptr;

    for (int i = 0; i < 1000000; i++) {
        sum += tmpptr->f2;
        tmpptr++;
    }

    printf("Sum = %.0f\n", sum);

    munmap(ptr, length);

    return 0;
}

 Task 3 	Writer #include <stdio.h>
#include <stdlib.h>
#include <fcntl.h>
#include <sys/mman.h>
#include <unistd.h>
#include <string.h>

int main() {
    int fd = open("mmfile.dat", O_RDWR | O_CREAT, 0666);
    size_t length = 1024;
    ftruncate(fd, length);

    char *ptr = mmap(NULL, length, PROT_WRITE | PROT_READ, MAP_SHARED, fd, 0);
    close(fd);

    if (ptr == MAP_FAILED) exit(1);

    strcpy(ptr, "Hello from writer!");

    munmap(ptr, length);
    return 0;
}

 Reader #include <stdio.h>
#include <stdlib.h>
#include <fcntl.h>
#include <sys/mman.h>
#include <unistd.h>

int main() {
    int fd = open("mmfile.dat", O_RDWR);
    size_t length = 1024;

    char *ptr = mmap(NULL, length, PROT_READ | PROT_WRITE, MAP_SHARED, fd, 0);
    close(fd);

    if (ptr == MAP_FAILED) exit(1);

    printf("Reader got: %s\n", ptr);

    munmap(ptr, length);
    return 0;
}

